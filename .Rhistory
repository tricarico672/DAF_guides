autoplot(us_employment)
library(fpp3)
library(latex2exp)
library(slider)
library(gridExtra)
view(us_employment)
unique(us_employment$Title)
library(fpp3)
library(latex2exp)
library(slider)
library(gridExtra)
employment %>%
filter(Title = "Retail Trade") %>%
autoplot()
library(fpp3)
library(latex2exp)
library(slider)
library(gridExtra)
us_employment %>%
filter(Title = "Retail Trade") %>%
autoplot()
library(fpp3)
library(latex2exp)
library(slider)
library(gridExtra)
us_employment %>%
filter(Title == "Retail Trade") %>%
autoplot()
us_employment %>%
filter(year(Month) >= 1990, year(Month) <= 1992) %>%
autplot()
us_employment %>%
filter(year(Month) >= 1990, year(Month) <= 1992) %>%
autoplot()
us_employment %>%
filter(Title = "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>%
autoplot()
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>%
autoplot()
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>%
autoplot(Employed)
library(fpp3)
library(latex2exp)
library(slider)
library(gridExtra)
library(ggthemes)
install.packages("ggthemes")
library(fpp3)
library(latex2exp)
library(slider)
library(gridExtra)
library(ggthemes)
us_employment %>%
filter(Title == "Retail Trade") %>% #<1>
autoplot(Employed) #<2>
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>% #<1>
autoplot(Employed) + #<2>
theme_minimal()
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>% #<1>
autoplot(Employed) + #<2>
theme_classic()
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>% #<1>
autoplot(Employed) + #<2>
theme_economist()
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>% #<1>
autoplot(Employed) #<2>
library(fpp3)
library(latex2exp)
library(slider)
library(gridExtra)
us_employment %>%
filter(Title == "Retail Trade") %>% #<1>
autoplot(Employed) #<2>
library(fpp3)
library(latex2exp)
library(slider)
library(gridExtra)
us_employment %>%
filter(Title == "Retail Trade") %>% #<1>
autoplot(Employed) #<2>
library(fpp3)
library(latex2exp)
library(slider)
library(gridExtra)
us_employment %>%
filter(Title == "Retail Trade") %>% #<1>
autoplot(Employed) #<2>
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>%
gg_subseries(Employed)
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>%
gg_subseries(Employed) +
theme(legend.position = "none")
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990, year(Month) <= 1992) %>%
gg_season(Employed)
us_employment %>%
filter(Title == "Retail Trade") %>%
mutate("5_ma" = slide_dbl(Employed, .before = 2, .after = 2, .complete = TRUE))
us_employment %>%
filter(Title == "Retail Trade") %>%
mutate("5_ma" = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE))
us_employment %>%
filter(Title == "Retail Trade") %>%
mutate("5_ma" = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(5_ma, color = "orange")
us_employment %>%
filter(Title == "Retail Trade") %>%
mutate("5_ma" = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line("5_ma", color = "orange")
us_employment %>%
filter(Title == "Retail Trade") %>%
mutate("5_ma" = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y="5_ma"), color = "orange")
us_employment %>%
filter(Title == "Retail Trade") %>%
mutate("5_ma" = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y=5_ma), color = "orange")
us_employment %>%
filter(Title == "Retail Trade") %>%
mutate("MA_5" = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y=MA_5), color = "orange")
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate("MA_5" = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y=MA_5), color = "orange")
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y=MA_5), color = "orange")
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y=MA_5, color = "orange"))
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y=MA_5), color = "orange")
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y=MA_5), color = "orange") +
legend(legend = "trend")
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y=MA_5), color = "orange")
us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE)) %>%
autoplot(Employed) +
geom_line(aes(y=MA_5), color = MA_5)
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE))
autoplot(employment_avg, Employed)
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE))
autoplot(employment_avg, Employed) +
geom_line(aes(y=MA_5))
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE))
pivot_longer(employment_avg, c(Employed, MA_5), names_to = "category", values_to = "values")
"autoplot(employment_avg, Employed) +
geom_line(aes(y=MA_5))"""
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE))
pivot_longer(employment_avg, c(Employed, MA_5), names_to = "category", values_to = "values")
#autoplot(employment_avg, Employed) +
# geom_line(aes(y=MA_5))
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE))
employment_long <- pivot_longer(employment_avg, c(Employed, MA_5), names_to = "category", values_to = "values")
autoplot(employment_long, values) +
geom_line(aes(y=values, color = category))
#autoplot(employment_avg, Employed) +
# geom_line(aes(y=MA_5))
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
select(-Series_ID) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE))
employment_long <- pivot_longer(employment_avg, c(Employed, MA_5), names_to = "category", values_to = "values")
autoplot(employment_long, values) +
geom_line(aes(y=values, color = category))
#autoplot(employment_avg, Employed) +
# geom_line(aes(y=MA_5))
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
select(-Series_ID) %>%
mutate(MA_7 = slide_dbl(Employed, mean, .before = 3, .after = 3, .complete = TRUE))
employment_long <- pivot_longer(employment_avg, c(Employed, MA_7), names_to = "category", values_to = "values")
autoplot(employment_long, values) +
geom_line(aes(y=values, color = category))
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
select(-Series_ID) %>%
mutate(MA_9 = slide_dbl(Employed, mean, .before = 4, .after = 4, .complete = TRUE))
employment_long <- pivot_longer(employment_avg, c(Employed, MA_9), names_to = "category", values_to = "values")
autoplot(employment_long, values) +
geom_line(aes(y=values, color = category))
# Global options for R code chunks
knitr::opts_chunk$set(fig.align = "center")
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
select(-Series_ID) %>%
mutate(MA_5 = slide_dbl(Employed, mean, .before = 2, .after = 2, .complete = TRUE))
employment_long <- pivot_longer(employment_avg, c(Employed, MA_5), names_to = "category", values_to = "values")
autoplot(employment_long, values) +
geom_line(aes(y=values, color = category))
#autoplot(employment_avg, Employed) +
# geom_line(aes(y=MA_5))
employment_avg <- us_employment %>%
filter(Title == "Retail Trade", year(Month) >= 1990) %>%
select(-Series_ID) %>%
mutate(MA_9 = slide_dbl(Employed, mean, .before = 4, .after = 4, .complete = TRUE))
employment_long <- pivot_longer(employment_avg, c(Employed, MA_9),
names_to = "category", values_to = "values")
autoplot(employment_long, values) +
geom_line(aes(y=values, color = category))
retail_employment <- us_employment %>%
filter(Title = "Retail Trade")
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
model(retail_employment, STL(Employed~Trend()+Season(),
robust = TRUE))
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
model(retail_employment, STL(Employed~Trend()+Season()))
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
retail_employment %>%
model(STL(Employed~Trend()+Season()))
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
retail_employment %>%
model(STL(Employed~trend()+season()))
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
retail_employment %>%
model(STL(Employed~trend()+season()),
robust = TRUE)
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
retail_employment %>%
model(STL(Employed~trend()+season(),
robust = TRUE))
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
stl_model <- retail_employment %>%
model(STL(Employed~trend()+season(),
robust = TRUE))
components(stl_model)
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
stl_model <- retail_employment %>%
model(STL(Employed~trend()+season(),
robust = TRUE))
components(stl_model) %>%
autoplot()
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
stl_model <- retail_employment %>%
model(STL(Employed~trend()+season(),
robust = TRUE))
components(stl_model) %>%
autoplot()
retail_employment %>%
trend(Employed)
retail_employment <- us_employment %>%
filter(Title == "Retail Trade")
stl_model <- retail_employment %>%
model(STL(Employed~trend()+season(),
robust = TRUE))
components(stl_model) %>%
autoplot()
view(global_economy)
gdp_pc <- global_economy %>%
mutate(GDP_PC = GDP / Population)
autoplot(gdp_pc, GDP_PC)
gdp_pc <- global_economy %>%
mutate(GDP_PC = GDP / Population)
autoplot(gdp_pc, GDP_PC) +
theme(legend.position = "none")
gdp_pc <- global_economy %>%
mutate(GDP_PC = GDP / Population)
autoplot(gdp_pc, GDP_PC) +
facet_grid(~Country) +
theme(legend.position = "none")
gdp_pc <- global_economy %>%
mutate(GDP_PC = GDP / Population)
autoplot(gdp_pc, GDP_PC) +
facet_wrap(~Country) +
theme(legend.position = "none")
gdp_pc <- global_economy %>%
mutate(GDP_PC = GDP / Population)
autoplot(gdp_pc, GDP_PC) +
theme(legend.position = "none")
gdp_pc <- global_economy %>%
mutate(GDP_PC = GDP / Population)
autoplot(gdp_pc, GDP_PC~Country) +
theme(legend.position = "none")
gdp_pc <- global_economy %>%
mutate(GDP_PC = GDP / Population)
autoplot(gdp_pc, GDP_PC, aes(group = Country)) +
theme(legend.position = "none")
us_gdp <- global_economy %>%
filter(Code == "USA")
us_gdp <- global_economy %>%
filter(Code == "USA")
autoplot(us_gdp, GDP)
gg_season(us_gdp, GDP)
view(aus_livestock)
bbs <- aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers")
autoplot(bbs, Count)
bbs <- aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers") %>%
select(-State)
autoplot(bbs, Count)
bbs
bbs <- aus_livestock %>%
group_by(Animal) %>%
filter(Animal == "Bulls, bullocks and steers") %>%
select(-State)
autoplot(bbs, Count)
bbs <- aus_livestock %>%
group_by(Animal) %>%
summarize(count = sum(Animal)) %>%
filter(Animal == "Bulls, bullocks and steers") %>%
select(-State)
bbs <- aus_livestock %>%
group_by(Animal) %>%
summarize(count = sum(Count)) %>%
filter(Animal == "Bulls, bullocks and steers") %>%
select(-State)
bbs <- aus_livestock %>%
group_by(Animal) %>%
summarize(count = sum(Count)) %>%
filter(Animal == "Bulls, bullocks and steers")
autoplot(bbs, Count)
bbs <- aus_livestock %>%
group_by(Animal) %>%
mutate(count = sum(Count)) %>%
filter(Animal == "Bulls, bullocks and steers")
autoplot(bbs, Count)
bbs <- aus_livestock %>%
group_by(Animal) %>%
summarize(count = sum(Count),
month = Month) %>%
filter(Animal == "Bulls, bullocks and steers")
bbs <- aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers")
autoplot(bbs, Count)
bbs <- aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers")
ggseason(bbs, Count)
bbs <- aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers")
gg_season(bbs, Count)
bbs
bbs <- aus_livestock %>%
key_drop() %>%
filter(Animal == "Bulls, bullocks and steers")
bbs <- aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers")
autoplot(bbs, Count)
bbs <- aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers")
autoplot(bbs, Count) +
theme(legend.position = "none")
features(bbs, Count, features = guerrero)
lambda <- features(bbs, Count, features = guerrero)$lambda_guerrero
bbs %>%
box_cox(lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)$lambda_guerrero
box_cox(bbs$count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)$lambda_guerrero
box_cox(bbs$Count, lambda = lambda)
bbs <- aus_livestock %>%
as_tibble() %>%
as_tsibble(index = Month) %>%
filter(Animal == "Bulls, bullocks and steers")
bbs <- aus_livestock %>%
filter(Animal == "Bulls, bullocks and steers")
autoplot(bbs, Count) +
theme(legend.position = "none")
lambda <- features(bbs, Count, features = guerrero)
box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
lambda
#box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
group_by_key(bbs)
#box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
bbs %>%
group_by_key() %>%
mutate(transformed = box_cox(Count, lambda))
lambda <- features(bbs, Count, features = guerrero)
lambda
#box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
for(i in lambda$lambda_guerrero){
print(i)
}
#box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
for(i in lambda){
print(i)
}
#box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
for(i,v in c(lambda$State, lambda$lambda_guerrero){
lambda <- features(bbs, Count, features = guerrero)
for(c(i,v) in c(lambda$State, lambda$lambda_guerrero){
lambda <- features(bbs, Count, features = guerrero)
for(i in c(lambda$State, lambda$lambda_guerrero){
lambda <- features(bbs, Count, features = guerrero)
for(i in lambda$lambda_guerrero){
print(i)
}
#box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
for(i in lambda$State){
bbs %>%
filter(State == i)
}
#box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
for(i in lambda$State){
ex <- bbs %>%
filter(State == i)
print(ex)
}
#box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
for(i in lambda$State){
ex <- bbs %>%
filter(State == i) %>%
mutate(transformed = box_cox(Count, lambda$lambda_guerrero[1]))
}
#box_cox(bbs$Count, lambda = lambda)
View(bbs)
View(ex)
lambda <- features(bbs, Count, features = guerrero)
for(state in lambda$State){
bbs %>%
mutate(transformed = ifelse(State == state, box_cox(., select(filter(lambda, State == state), lambda_guerrero)), .)
}
lambda <- features(bbs, Count, features = guerrero)
for(state in lambda$State){
bbs %>%
mutate(transformed = ifelse(State == state, box_cox(., select(filter(lambda, State == state), lambda_guerrero)), .))
}
lambda <- features(bbs, Count, features = guerrero)
for(state in lambda$State){
bbs %>%
mutate(transformed = ifelse(State == state, box_cox(Count, select(filter(lambda, State == state), lambda_guerrero)), Count))
}
#box_cox(bbs$Count, lambda = lambda)
lambda <- features(bbs, Count, features = guerrero)
for(state in lambda$State){
bbs1 <- bbs %>%
mutate(transformed = ifelse(State == state, box_cox(Count, select(filter(lambda, State == state), lambda_guerrero)), Count))
}
#box_cox(bbs$Count, lambda = lambda)
View(bbs1)
select(filter(lambda, State == state), lambda_guerrero)
lambda <- features(bbs, Count, features = guerrero)
for(state in lambda$State){
bbs1 <- bbs %>%
mutate(transformed = ifelse(State == state, box_cox(Count, pull(filter(lambda, State == state), lambda_guerrero)), Count))
}
#box_cox(bbs$Count, lambda = lambda)
View(bbs1)
# Check the structure of lambda to ensure it contains the required columns
lambda <- features(bbs, Count, features = guerrero)
# Initialize transformed column in bbs
bbs <- bbs %>% mutate(transformed = Count)
# Loop through states and apply the transformation
for (state in lambda$State) {
lambda_value <- filter(lambda, State == state) %>% pull(lambda_guerrero)
bbs <- bbs %>%
mutate(transformed = ifelse(State == state, box_cox(Count, lambda_value), transformed))
}
View(bbs)
autoplot(bbs, transformed)
View(bbs)
autoplot(bbs, transformed) +
theme(legend.position = "none")
